name: Lean4 Verification

on: [push, pull_request]

jobs:
  lean4-build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Install Lean4
        run: |
          curl https://raw.githubusercontent.com/leanprover/elan/master/elan-init.sh -sSf | sh -s -- -y
          echo "$HOME/.elan/bin" >> $GITHUB_PATH
      
      - name: Build Lean4 proofs
        run: |
          cd Lean4-Formalization
          lake build
      
      - name: Check for sorry statements
        run: |
          SORRY_COUNT=$(find Lean4-Formalization -name "*.lean" -exec grep -c "sorry" {} \; | awk '{s+=$1} END {print s}')
          echo "Sorry count: $SORRY_COUNT"
          if [ "$SORRY_COUNT" -gt 0 ]; then
            echo "❌ Found $SORRY_COUNT sorry statements"
            exit 1
          fi
          echo "✅ No sorry statements found!"
      
      - name: Generate badge
        if: success()
        run: |
          echo "✅ Lean4 Verified (0 axioms)" > lean_status.txt
